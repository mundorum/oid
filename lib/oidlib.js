!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.oidlib=t():e.oidlib=t()}(self,(()=>(()=>{"use strict";var e={d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Bus:()=>n,ButtonOid:()=>f,ConsoleOid:()=>v,FileOid:()=>_,ImageOid:()=>b,Oid:()=>u,OidBase:()=>h,OidPlay:()=>p,OidSphere:()=>l,OidUI:()=>d,OidWeb:()=>c,Primitive:()=>a,SliderOid:()=>g,Sphere:()=>o,SplitPaneOid:()=>w,SwitchOid:()=>y,css:()=>i,html:()=>s});const s=(e,...t)=>String.raw({raw:e},...t),i=(e,...t)=>String.raw({raw:e},...t);class n{constructor(){this._listeners={},this._listenersRgx=[],this._providers={},this._pendingCnx={}}subscribe(e,t){if(null!=e){let s={};"string"==typeof e&&null!=t?s[e]=t:"object"==typeof e&&(s=e);const i=this._listenersRgx.slice(),r={...this._listeners};for(const e in s)null!=s[e]&&(e.includes("+")||e.includes("#")?i.push([n._convertRegExp(e),s[e],e]):(null==r[e]?r[e]=[]:r[e]=r[e].slice(),r[e].push(s[e])));this._listenersRgx=i,this._listeners=r}}unsubscribe(e){if(null!=e){const t={};"string"==typeof e&&null!=handler?t[e]=handler:"object"==typeof e&&(t=e);const s=this._listenersRgx.slice(),i={...this._listeners};for(const e in t)if(e.includes("+")||e.includes("#")){for(const i in s)if(s[i][1]===t[e]&&s[i][2]==e){s.splice(i,1);break}}else if(null!=i[e])for(const s in i[e])if(i[e][s]===t[e]){i[e]=i[e].toSplice(s,1);break}this._listenersRgx=s,this._listeners=i}}async publish(e,t){if(null!=this._listeners[e])for(const s of this._listeners[e])s(e,t);const s=this._listenersRgx;for(const i of s){const s=i[0].exec(e);null!=s&&s[0]===e&&i[1](e,t)}}static _convertRegExp(e){return new RegExp(e.replace(/\//g,"\\/").replace(/\+/g,"[^/]+").replace(/#/g,".+"))}provide(e,t,s){let i=!1;if(null!=t&&null!=e&&null!=s){const n=e+"#"+t;if(null==this._providers[n]&&(i=!0,this._providers[n]=s,null!=this._pendingCnx[n])){for(let i of this._pendingCnx[n])i.connectionReady(e,t,s);delete this._pendingCnx[n]}}return i}withhold(e,t){let s=!1;if(null!=t&&null!=e){const i=e+"#"+t;this._providers[i]&&(s=!0,delete this._providers[i])}return s}connect(e,t,s){if(null!=t&&null!=e&&null!=s){const i=e+"#"+t;this._providers[i]?s.connectionReady(e,t,this._providers[i]):this._pendingCnx[i]?this._pendingCnx[i].push(s):this._pendingCnx[i]=[s]}}async invoke(e,t,s,i){const n=e+"#"+t;return null!=this._providers[n]?await this._providers[n].handleInvoke(e,s,i):null}}n.i=new n;const r={bus:n.i,stylesheet:["/lib/oiddefault.css"],assets:"/assets/"};class o{constructor(e,t,s){this._bus=e||o.i.bus,this._stylesheet=t||o.i.stylesheet,this._assets=s||o.i.assets}get bus(){return this._bus}set stylesheet(e){this._stylesheet=e}get stylesheet(){return this._stylesheet}set assets(e){this._assets=e}get assets(){return this._assets}}o.i=new o(r.bus,r.stylesheet,r.assets);class l extends HTMLElement{connectedCallback(){this.hasAttribute("global")?(this._sphere=o.i,this.hasAttribute("stylesheet")&&(o.i.stylesheet=this.getAttribute("stylesheet")),this.hasAttribute("assets")&&(o.i.assets=this.getAttribute("assets"))):this._sphere=new o(new n,this.getAttribute("stylesheet"),this.getAttribute("assets"))}static get observedAttributes(){return["stylesheet","assets"]}get stylesheet(){return this._sphere.stylesheet}get assets(){return this._sphere.assets}get sphere(){return this._sphere}}l.elementTag="oid-sphere",customElements.define(l.elementTag,l);class a extends HTMLElement{constructor(){super(),this._sphere=null}get _bus(){return this._sphere.bus}connectedCallback(){let e=this._findAggregator(l);this._sphere=null!=e?e.sphere:o.i}_findAggregator(e){let t=null!=this.parentNode?this.parentNode:this instanceof DocumentFragment?this.host:null;for(;null!=t&&!(t instanceof e);)t=null!=t.parentNode?t.parentNode:t instanceof DocumentFragment?t.host:null;return t}_subscribe(e,t){null!=this._bus&&this._bus.subscribe(e,t)}_unsubscribe(e,t){this._bus.unsubscribe(e,t)}async _publish(e,t){await this._bus.publish(e,t)}_provide(e,t,s){this._bus.provide(e,t,s)}_withhold(e,t){this._bus.withhold(e,t)}_connect(e,t,s){this._bus.connect(e,t,s)}async _invoke(e,t,s,i){return await this._bus.invoke(e,t,s,i)}}class h extends a{constructor(){super(),this._mapTopicNotice={},this._rgxTopicNotice=[],this._mapNoticeTopic={},this._receiveHandler={},this._provideHandler={},this._connected={},this._convertNotice=this._convertNotice.bind(this),this.handleNotice=this.handleNotice.bind(this)}connectedCallback(){super.connectedCallback(),this._initialize()}disconnectedCallback(){this._finalize()}_initialize(){const e=this.constructor.spec;if(e&&(this._buildHandlers(this._receiveHandler,e.receive),this._buildProviders(),this._buildProvidersHandlers(),this._buildEventDispatchers(e.dispatcher)),e&&e.properties)for(const[t,s]of Object.entries(e.properties))null==s.default||this.hasAttribute(t)||(this[t]=s.default);this.hasAttribute("publish")&&this._publishNoticeTopic(this.getAttribute("publish")),this.hasAttribute("subscribe")&&this._subscribeTopicNotice(this.getAttribute("subscribe")),this.hasAttribute("connect")&&this._connectInterface(this.getAttribute("connect"))}_buildProviders(){const e=this.constructor.spec;if(null!=e.provide&&this.id)for(const t in e.provide)this._provide(t,this.id,this)}_buildProvidersHandlers(){const e=this.constructor.spec;if(null!=e.provide)for(const t in e.provide)this._buildHandlers(this._provideHandler,e.provide[t].operations,t)}_removeProviders(){const e=this.constructor.spec;if(null!=e.provide&&this.id)for(const t in e.provide)this._withhold(t,this.id)}_buildHandlers(e,t,s){if(null!=t){const i=null==s?"":s+".";if(Array.isArray(t))for(const s of t)null==e[i+s]&&(e[i+s]=this["handle"+s[0].toUpperCase()+s.slice(1)].bind(this));else for(const[s,n]of Object.entries(t))if(null==e[i+s]){const t="string"==typeof n?n:null!=n.handler?n.handler:"handle"+s[0].toUpperCase()+s.slice(1);e[i+s]=this[t].bind(this)}}}_buildEventDispatchers(e){if(e){this._dispatcher=[];for(const[t,s,i]of e)this._dispatcher.push([t,s,i.bind(this)])}}_finalize(){this._removeProviders();for(const e in this._mapTopicNotice)this._mapTopicNotice[e]!=e?this._unsubscribe(e,this._convertNotice):this._unsubscribe(e,this.handleNotice)}attributeChangedCallback(e,t,s){this[e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()))]=s}static get observedAttributes(){return["id"]}get id(){return this._id}set id(e){null!=this._id&&null!=this._bus&&this._removeProviders(),this._id=e,null!=this._bus&&this._buildProviders()}get publish(){return this.getAttribute("publish")}get subscribe(){return this.getAttribute("subscribe")}get connect(){return this.getAttribute("connect")}handleGet(e,t){return null!=t.property?this[t.property]:null}handleSet(e,t){null!=t.property&&null!=t.value&&(this[t.property]=t.value)}_subscribeTopicNotice(e){const t=e.split(";");for(const e of t){const t=e.split("~");if(t.length>1){const e=t[0].trim();e.includes("+")||e.includes("#")?this._rgxTopicNotice.push([n._convertRegExp(e),t[1].trim(),e]):this._mapTopicNotice[e]=t[1].trim(),this._subscribe(e,this._convertNotice)}else{const t=e.trim();this._mapTopicNotice[t]=t,this._subscribe(t,this.handleNotice)}}}_publishNoticeTopic(e){const t=e.split(";");for(const e of t){const t=e.split("~");t.length>1?this._mapNoticeTopic[t[0].trim()]=t[1].trim():this._mapNoticeTopic[e.trim()]=e.trim()}}_connectInterface(e){let t=!0;const s=e.split(";");for(const e of s){const s=e.split("#");s.length>1?this._connect(s[0].trim(),s[1].trim(),this):t=!1}return t}_notify(e,t){null!=this._mapNoticeTopic[e]&&this._publish(this._mapNoticeTopic[e],t)}_convertNotice(e,t){if(null!=this._mapTopicNotice[e])this.handleNotice(this._mapTopicNotice[e],t);else for(const[s,i]of this._rgxTopicNotice){const n=s.exec(e);if(null!=n&&n[0]===e){this.handleNotice(i,t);break}}}connectTo(e,t){t.id&&this._connect(e,t.id,this)}connectionReady(e,t,s){null==this._connected[e]&&(this._connected[e]=[]),this._connected[e].push(t)}async _invoke(e,t,s){const i=u.getInterface(e);if(null!=this._connected[e]){if(null!=i.response&&!0===i.response){const n=[];for(const i of this._connected[e])n.push(await this._bus.invoke(e,i,t,s));return i.cardinality&&"1"==i.cardinality[2]?n[0]:n}for(const i of this._connected[e])return await this._bus.invoke(e,i,t,s)}}handleNotice(e,t){null!=this._receiveHandler[e]&&this._receiveHandler[e](e,t)}handleInvoke(e,t,s){let i=null;return null!=this._provideHandler[e+"."+t]&&(i=this._provideHandler[e+"."+t](t,s)),i}}class c extends h{}class d extends c{connectedCallback(){super.connectedCallback(),this._defaultStyle=this.constructor.spec.defaultStyle?`<link href="${this._sphere.stylesheet}" rel="stylesheet">`:"",this.render()}render(){const e=this.constructor.spec;let t=null!=e?e.template:null;if(this.template){const e=this.template();if(e!=this._template){this._template=e;const t=u.prepareDispatchers(e,this.constructor);this._templatePre=t.template,this._buildEventDispatchers(t.dispatcher,this)}t=this._templatePre}if(this._presentation=null,null!=e&&null!=t){const s=(this._defaultStyle+e.styles+t).replace(/{{[ \t]*(url:)?[ \t]*this\.([^}]*)}}/g,((e,t,s)=>{let i=this[s=s?s.trim():""]?this[s]:"";return"url:"===t&&(i=i.replace("assets:",this._sphere.assets)),i}));if(!1===e.shadow?(this.innerHTML=s,this._presentation=this.querySelector("#oid-prs")||this):this._presentation=this._shadowHTML(s),this._dispatcher){const t=!1===e.shadow?this:this.shadowRoot;for(const[e,s,i]of this._dispatcher)t.querySelector("["+e+"]").addEventListener(s,i)}}}_shadowHTML(e){const t=d.prepareShadow(this,e);return this.shadowRoot.querySelector("#oid-prs")||t}static prepareShadow(e,t){const s=document.createElement("template");s.innerHTML=t;const i=document.importNode(s.content,!0);return e.shadowRoot?e.shadowRoot.innerHTML="":e.attachShadow({mode:"open"}),e.shadowRoot.appendChild(i),i}}class u{static eventAttribute="oidevent_";static defaultInterface=["itf:oid"];static _interfaceReg={};static _oidReg={};static _defaultSpec={};static cInterface(e){null!=e&&(u._interfaceReg[e.id]=e)}static getInterface(e){return u._interfaceReg[e]}static component(e){let t=(e=Object.assign({},u._defaultSpec,e)).implementation;if(null==t){const s=!1===e.ui||null==e.template?null==e.element?h:c:d,i=e.element[0].toUpperCase()+e.element.slice(1).replace(/-([a-z])/g,((e,t)=>t.toUpperCase()));t=class extends s{},Object.defineProperty(t,"name",{value:i})}const s=t.observedAttributes.slice();if(e.properties){Object.defineProperty(t,"observedAttributes",{get:function(){return this.observed}});for(const i in e.properties){const n=e.properties[i],r=i.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()));Object.defineProperty(t.prototype,r,null==t.prototype.render?{get:function(){return this["_"+r]},set:function(e){this["_"+r]=e}}:{get:function(){return this["_"+r]},set:function(e){const t=this["_"+r];this["_"+r]=e,t!=e&&this._sphere&&this.render()}}),null!=n.attribute&&!1===n.attribute||s.push(i)}}if(e.provide=null==e.provide?u.defaultInterface:e.provide.concat(u.defaultInterface),e.provide){const t={};for(const s of e.provide){const e=u._interfaceReg[s];if(null==e)throw new Error("Unknown interface id: "+s);t[s]=e}e.provide=t}u.stylePreprocess(e);const i=u.prepareDispatchers(e.template,t);e.template=i.template,i.dispatcher&&(e.dispatcher=i.dispatcher),Object.assign(t,{spec:e,observed:s}),null==e.element&&(e.element="internal-"+e.id.replace(":","-")),customElements.define(e.element,t),u._oidReg[e.id]=t}static componentSet(e,t){if(null!=e&&null!=u._oidReg[e]){const s=u._oidReg[e].spec;for(const e in t)s[e]=t[e];u.stylePreprocess(s)}}static stylePreprocess(e){e.defaultStyle=!1;let t="";if(e.stylesheet){let s=e.stylesheet;Array.isArray(s)||(s=[s]);for(const i of s)"default"==i?e.defaultStyle=!0:t+=`<link href="${i}" rel="stylesheet">`}e.styles&&(t+=e.styles?`<style>${e.styles}</style>`:""),e.styles=t}static prepareDispatchers(e,t){let s=null;if(e){let i=1;const n=e.split(/@([^= >]*)[ \t]*(?:=[ \t]*{{[ \t]*this\.([^}]*)[ \t]*}})?/);if(n.length>1){s=[];let r="";for(let e=0;e+2<n.length;e+=3){r+=n[e]+u.eventAttribute+i+" ";const o=n[e+1].trim(),l=null!=n[e+2]?n[e+2].trim():"_on"+o[0].toUpperCase()+o.substring(1);s.push([u.eventAttribute+i,o,t.prototype[l]]),i++}e=r+n[n.length-1]}}return{template:e,dispatcher:s}}static create(e,t){const s=u._oidReg[e];if(null==s)throw new Error("Unknown component id: "+e);const i=document.createElement(s.spec.element);if(null!=t)for(const e in t)i.setAttribute(e,t[e]);return i}static setDefault(e){this._defaultSpec=e}static addDefault(e){for(const t in e)null==this._defaultSpec[t]?this._defaultSpec[t]=e[t]:Array.isArray(this._defaultSpec[t])?this._defaultSpec[t]=this._defaultSpec[t].concat(e[t]):"object"==typeof this._defaultSpec[t]?Object.assign(this._defaultSpec[t],e[t]):this._defaultSpec[t]=e[t]}}u.cInterface({id:"itf:oid",operations:{get:{response:!0},set:{response:!1}},cardinality:"n:n"}),u.cInterface({id:"itf:transfer",operations:["send"],cardinality:"n:n"}),u.cInterface({id:"itf:iterate",operations:{first:{response:!0},next:{response:!0}},cardinality:"1:n"});class p extends l{connectedCallback(){super.connectedCallback();const e=this._prepareHTML(),t=p.template.replace("{stylesheet}",this.stylesheet).replace("{code}",p.code.replace("{html}",e).replace("{rows}",this._rows(e))).replace("{console}",this.messages?p.console.replace("{rows}",this.rows?this.rows:p.rows):"");d.prepareShadow(this,t),this._scriptPanel=this.shadowRoot.querySelector("#script"),this._unlockScript=this._unlockScript.bind(this),this._scriptPanel.addEventListener("click",this._unlockScript),this._buttonRender=this.shadowRoot.querySelector("#btn-render"),this._buttonRender.addEventListener("click",this._computeRender.bind(this)),this._observer=new MutationObserver(this._scriptUpdated.bind(this)),this._observer.observe(this,{attributes:!0,childList:!0,subtree:!0}),this.sphere.bus.subscribe("#",this._busMonitor.bind(this))}static get observedAttributes(){return l.observedAttributes.concat(["messages","rows"])}get messages(){return this.hasAttribute("messages")}get messages(){return this.hasAttribute("messages")}get rows(){return this.getAttribute("rows")}set rows(e){this.setAttribute("rows",e)}_scriptUpdated(e,t){const s=this._prepareHTML();this._scriptPanel.value=s,this._scriptPanel.rows=this._rows(s)}_rows(e){const t=e.split(/\r\n|\r|\n/);let s=0;return t.forEach((e=>{s+=Math.floor(e.length/45)+1})),s}_prepareHTML(){let e=this.innerHTML.replace('=""',"").replace(/^[\r\n]+/,"").replace(/[\r\n]+$/,"");if(e.startsWith(" ")||e.startsWith("\t")){const t=e.match(/^[ \t]+/);e=e.replace(new RegExp("^"+t,"gm"),"")}return e}_unlockScript(){this._scriptPanel.removeEventListener("click",this._unlockScript),this._scriptPanel.readOnly=!1,this._buttonRender.style.display="initial"}_computeRender(){this.shadowRoot.querySelector("#render").innerHTML=this._scriptPanel.value}_busMonitor(e,t){"bus/monitor"!=e&&this.sphere.bus.publish("bus/monitor",{value:`[${e}] ${JSON.stringify(t)}`})}}p.rows=5,p.code=s`<div style="width:100%;display:flex">
<textarea id="script" class="code" style="width:100%;cursor:pointer" rows="{rows}" readonly>{html}</textarea>
<button id="btn-render" class="btn btn-secondary" style="width:auto;display:none">Render</button>
</div>`,p.template=s`<link rel="stylesheet" href="{stylesheet}">
{code}
<div id="render"><slot></slot></div>
{console}`,p.console=s`<div id="msg-pnl" style="width:100%">
  <b>Messages on the Bus</b><br>
  <console-oid rows="{rows}" class="code" prompt="" subscribe="bus/monitor~display"></console-oid>
</div>`,p.elementTag="oid-play",customElements.define(p.elementTag,p);class _ extends d{_onDragover(e){this.pre&&(this._presentation.innerHTML=this.pre),e.preventDefault()}async _onDrop(e){e.preventDefault(),this.post&&(this._presentation.innerHTML=this.post);let t=null;if(e.dataTransfer.items)for(let s of e.dataTransfer.items)"file"===s.kind&&(t=s.getAsFile());else t=e.dataTransfer.files[0];const s=await t.text();this._notify("loaded",{value:s}),this._invoke("itf:transfer","send",{value:s})}}u.component({id:"oid:file",element:"file-oid",properties:{label:{default:"Drop Zone"},pre:{default:"Drop your file here"},post:{default:"File loaded"}},implementation:_,styles:i`
  #oid-prs {
    border: 5px solid;
  }`,template:s`
  <div id="oid-prs" @dragover @drop>{{this.label}}</div>`});class b extends d{_onClick(){this._notify("click",{value:this.label||this.source})}_onMouseenter(){this._notify("mouseenter",{value:this.label||this.source})}_onMouseleave(){this._notify("mouseleave",{value:this.label||this.source})}}u.component({id:"oid:image",element:"image-oid",properties:{source:{default:"assets:images/image.svg"},label:{}},implementation:b,stylesheet:"default",template:s`
  <image id="oid-prs" src="{{url:this.source}}" alt="{{this.label}}"
    @click @mouseenter @mouseleave>`});class f extends d{_onClick(){this._notify("click",{value:this.value||this.label}),this._invoke("itf:transfer","send",{value:this.value||this.label})}_onMouseenter(){this._notify("mouseenter",{value:this.value||this.label})}_onMouseleave(){this._notify("mouseleave",{value:this.value||this.label})}}u.component({id:"oid:button",element:"button-oid",properties:{label:{},value:{}},implementation:f,stylesheet:"default",template:s`
  <button id="oid-prs" class="btn btn-primary"
    @click @mouseenter @mouseleave>
    {{this.label}}
  </button>`});class v extends d{handleSend(e,t){this._presentation&&t&&t.value&&(this._presentation.value+=(this.prompt.length>0?`${this.prompt} `:"")+`${t.value}\n`)}}u.component({id:"oid:console",element:"console-oid",properties:{prompt:{default:">"},rows:{default:10}},receive:{display:"handleSend"},provide:["itf:transfer"],implementation:v,styles:i`
  .console {
    width: 100%;
    font-family: "Courier New", monospace;
    font-size: 1em;
    background-color: lightgray
  }`,template:s`
  <textarea class="console" rows="{{this.rows}}" id="oid-prs" readonly></textarea>`});class m extends d{connectedCallback(){this._value=this.getAttribute("value")||!1,super.connectedCallback()}static get observedAttributes(){return d.observedAttributes.concat(["variable","value"])}get variable(){return this._variable}set variable(e){this._variable=e}get value(){return this._value}set value(e){this._value=e}}class y extends m{connectedCallback(){super.connectedCallback(),this.hasAttribute("value")&&(this.value=!("off"===this.getAttribute("value")),this.render()),this._notify("initial",{value:this.value?this.on:this.off})}render(){super.render(),this._input=this._presentation.querySelector("#oid-input"),this._input.checked=this.value}handleInvert(e,t){this.value=!this.value,this.value?this._input.checked=!0:this._input.checked=!1}_onInput(){console.log("=== input"),this._value=this._input.checked,this._notify("change",{value:this.value?this.on:this.off})}}u.component({id:"oid:switch",element:"switch-oid",properties:{on:{default:"on"},off:{default:"off"}},receive:["invert"],implementation:y,styles:i`
  .switch {
    position: relative;
    display: inline-block;
    width: 60px;
    height: 34px;
  }
  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }
  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    -webkit-transition: .4s;
    transition: .4s;
  }
  .slider:before {
    position: absolute;
    content: "";
    height: 26px;
    width: 26px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    -webkit-transition: .4s;
    transition: .4s;
  }
  input:checked + .slider {
    background-color: #2196F3;
  }
  input:focus + .slider {
    box-shadow: 0 0 1px #2196F3;
  }
  input:checked + .slider:before {
    -webkit-transform: translateX(26px);
    -ms-transform: translateX(26px);
    transform: translateX(26px);
  }
  .slider.round {
    border-radius: 34px;
  }
  .slider.round:before {
    border-radius: 50%;
  }`,template:s`
  <label id="oid-prs" class="switch">
    <input id="oid-input" type="checkbox" @input>
    <span class="slider round"></span>
  </label>`});class g extends m{connectedCallback(){super.connectedCallback(),this.hasAttribute("value")||(this.value=Math.round((parseInt(""+this.min)+parseInt(""+this.max))/2),this.render()),this._notify("initial",{value:this.value})}render(){super.render(),this._input=this._presentation.querySelector("#oid-input"),this.hasAttribute("index")&&(this._index=this._presentation.querySelector("#index"),this._index.innerHTML=this.value)}_onInput(){this._value=this._input.value,this.hasAttribute("index")&&(this._index.innerHTML=this.value),this._notify("change",{value:this.value})}}u.component({id:"oid:slider",element:"slider-oid",properties:{min:{default:0},max:{default:100},index:{default:!1}},implementation:g,stylesheet:"default",template:s`
  <div id="oid-prs" style="width:100%; display:flex; flex-direction:row">
    <span id="index" style="flex:initial"></span>
    <input type="range" id="oid-input" min="{{this.min}}" max="{{this.max}}"
           value="{{this.value}}" style="flex:auto" @input>
  </div>`});class w extends d{constructor(){super(),this._x=0,this._y=0,this._sideASize=0,this._onMousemove=this._onMousemove.bind(this),this._onMouseup=this._onMouseup.bind(this)}connectedCallback(){super.connectedCallback(),this._horz=!("vertical"===this.split),this._resizer=this.shadowRoot.getElementById("resizer"),this._sidea=this.shadowRoot.getElementById("sidea"),this._sideb=this.shadowRoot.getElementById("sideb"),this._horz?(this._resizer.style.cursor="ew-resize",this._resizer.style.height="100%",this._resizer.classList.add("divide-x"),this._sidea.style.width=this.proportion):(this._resizer.style.cursor="ns-resize",this._presentation.style.flexDirection="column",this._resizer.style.width="100%",this._resizer.classList.add("divide-y"),this._sidea.style.height=this.proportion)}_onMousedown(e){this._x=e.clientX,this._y=e.clientY,this._sideASize=this._horz?this._sidea.getBoundingClientRect().width:this._sidea.getBoundingClientRect().height,this.shadowRoot.addEventListener("mousemove",this._onMousemove),this.shadowRoot.addEventListener("mouseup",this._onMouseup)}_onMousemove(e){const t=e.clientX-this._x,s=e.clientY-this._y;if(this._horz){const e=100*(this._sideASize+t)/this._presentation.getBoundingClientRect().width;this._sidea.style.width=e+"%",this._resizer.style.cursor="col-resize",document.body.style.cursor="col-resize"}else{const e=100*(this._sideASize+s)/this._presentation.getBoundingClientRect().height;this._sidea.style.height=e+"%",this._resizer.style.cursor="row-resize",document.body.style.cursor="row-resize"}this._sidea.style.userSelect="none",this._sidea.style.pointerEvents="none",this._sideb.style.userSelect="none",this._sideb.style.pointerEvents="none"}_onMouseup(e){this.shadowRoot.removeEventListener("mousemove",this._onMousemove),this.shadowRoot.removeEventListener("mouseup",this._onMouseup),this._resizer.style.cursor=this._horz?"ew-resize":"ns-resize",document.body.style.removeProperty("cursor"),this._sidea.style.removeProperty("user-select"),this._sidea.style.removeProperty("pointer-events"),this._sideb.style.removeProperty("user-select"),this._sideb.style.removeProperty("pointer-events")}}return u.component({id:"oid:split-pane",element:"split-pane-oid",properties:{split:{default:"horizontal"},proportion:{default:"50%"}},implementation:w,stylesheet:"default",styles:i`
  .group {
    display: flex;
    width: 100%;
    height: 100%;
  }
  .pane-b {
    flex: 1;
  }`,template:s`
  <div id="oid-prs" class="group">
    <div class="bg-base" id="sidea"><slot name="side-a"></slot></div>
    <div class="divide" id="resizer" @mousedown></div>
    <div class="pane-b bg-base" id="sideb"><slot name="side-b"></slot></div>
  </div>`}),t})()));