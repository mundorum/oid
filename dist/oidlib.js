!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.oidlib=e():t.oidlib=e()}(self,(()=>(()=>{"use strict";var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Bus:()=>s,ButtonOid:()=>c,Oid:()=>r,OidBase:()=>o,OidUI:()=>n,Primitive:()=>i});class s{constructor(){this._listeners=[],this._providers={},this._connections={}}subscribe(t,e){if(null!=t){let i={};"string"==typeof t&&null!=e?i[t]=e:"object"==typeof t&&(i=t),console.log("=== subscribe"),console.log(i);const o=this._listeners.slice();for(const t in i)null!=i[t]&&(t.includes("+")||t.includes("#")?o.push({topic:t,regexp:s._convertRegExp(t),handler:i[t]}):o.push({topic:t,handler:i[t]}));this._listeners=o}}unsubscribe(t){if(null!=t){const e={};"string"==typeof t&&null!=handler?e[t]=handler:"object"==typeof t&&(e=t);const s=this._listeners.slice();for(const t in e)for(const i in this._listeners)if(this._listeners[i].topic===t&&this._listeners[i].handler===e[t]){s.splice(i,1);break}this._listeners=s}}async publish(t,e){console.log("=== publish"),console.log(t),console.log(this._listeners);let s=!1;const i=this._listeners;for(const o in i){if(i[o].regexp){const e=i[o].regexp.exec(t);null!=e&&e[0]===t&&(s=!0)}else i[o].topic===t&&(s=!0);s&&i[o].handler(t,e)}}static _convertRegExp(t){return new RegExp(t.replace(/\//g,"\\/").replace(/\+/g,"[^/]+").replace(/#/g,".+"))}}s.i=new s;class i extends HTMLElement{constructor(){super(),this._bus=s.i}_subscribe(t,e){return this._bus.subscribe(t,e)}_unsubscribe(t,e){this._bus.unsubscribe(t,e)}async _publish(t,e){await this._bus.publish(t,e)}}class o extends i{constructor(){super(),this._toNotify=this._toNotify.bind(this),this.notified=this.notified.bind(this),this._buildNotification()}connectedCallback(){this.hasAttribute("publish")&&this._mapNoticeTopic(this.publish),this.hasAttribute("subscribe")&&this._subscribeTopic(this.subscribe)}disconnectedCallback(){null!=this._subsTopic&&(null!=this._subsNote?this._unsubscribe(this._subsTopic,this._toNotify):this._unsubscribe(this._subsTopic,this.notified))}static get observedAttributes(){return["publish","subscribe"]}get publish(){return this.getAttribute("publish")}set publish(t){this.setAttribute("publish",t),this._mapNoticeTopic(t)}get subscribe(){return this.getAttribute("subscribe")}set subscribe(t){this.setAttribute("subscribe",t),this._subscribeTopic(t)}_subscribeTopic(t){const e=t.lastIndexOf(":");-1!=e?(this._subsTopic=t.substring(0,e),this._subsNotice=t.substring(e+1),this._subscribe(this._subsTopic,this._toNotify),console.log("=== map topic/notice"),console.log(this._subsTopic,this._toNotify)):(this._subsTopic=t,this._subscribe(t,this.notified))}_mapNoticeTopic(t){const e=t.lastIndexOf(":");-1!=e?(this._pubNotice=t.substring(0,e),this._pubTopic=t.substring(e+1)):(this._pubNotice=t,this._pubTopic=t)}_toNotify(t,e){console.log("=== _toNotify",t),this.notified(this._subsNotice?this._subsNotice:t,e)}notify(t,e){console.log("=== notify",t,e),null!=this._pubNotice&&this._pubNotice==t&&null!=this._pubTopic&&this._publish(this._pubTopic,e)}notified(t,e){if(console.log("=== notified",t,e),null!=this._noteHandler){const s=this._noteHandler[t];null!=s&&s(t,e)}}_buildNotification(){const t=this.constructor.spec;if(null!=t&&null!=t.notify)if(this._noteHandler={},Array.isArray(t.notify))for(const e of t.notify)this._noteHandler[e]=this["notify"+e[0].toUpperCase()+e.slice(1)].bind(this);else for(const[e,s]of Object.entries(t.notify))this._noteHandler[e]=this[s].bind(this)}}class n extends o{connectedCallback(){super.connectedCallback(),this.render()}render(){const t=this.constructor.spec;t.template&&(!1===t.shadow?this.innerHTML=t.template:this._shadowHTML(t.template))}_shadowHTML(t){const e=document.createElement("template");e.innerHTML=t.replace(/{{this\.([^}]*)}}/g,((t,e)=>this[e]));const s=document.importNode(e.content,!0);return this.shadowRoot?this.shadowRoot.innerHTML="":this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(s),this.shadowRoot.querySelector("#oid-prs")||s}}class r{static component(t){let e=t.implementation;if(null==e){const s=!1===t.ui?o:n,i=t.element[0].toUpperCase()+t.element.slice(1).replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()}));e=class extends s{},Object.defineProperty(e,"name",{value:i})}const s=[];if(t.properties){Object.defineProperty(e,"observedAttributes",{get:function(){return this.observed}});for(const i in t.properties){const o=t.properties[i];Object.defineProperty(e.prototype,i,null==e.prototype.render?{get:function(){return this["_"+i]},set:function(t){console.log("=== set "+i),console.log(t),this["_"+i]=t}}:{get:function(){return this["_"+i]},set:function(t){console.log("=== set "+i),console.log(t),this["_"+i]=t,this.render()}}),null!=o.attribute&&!1===o.attribute||s.push(o.attribute?o.attribute:i)}}e.prototype.attributeChangedCallback=function(t,e,s){this[t]=s},Object.assign(e,{spec:t,observed:s}),customElements.define(t.element,e)}}class c extends n{render(){const t=this._shadowHTML(c.template);t.style.cursor="pointer",this.author||t.addEventListener("click",this._computeTrigger.bind(this))}_computeTrigger(){this.notify("clicked",{value:this.label})}}return c.template='<style>\n.button {\n  border: 1px solid lightgray;\n  border-radius: 5px;\n  margin: 5px;\n  color: #1d1d1b;\n  padding: 14px 25px;\n  text-align: center;\n  text-decoration: none;\n  display: block;\n  width: 50%;\n}\n.button:hover {\n  color: black;\n  font-weight: bold;\n  cursor: pointer;\n}\n</style>\n<span id="oid-prs" class="button">{{this.label}}</span>',r.component({id:"oid:button",element:"button-oid",properties:{label:{}},implementation:c}),e})()));